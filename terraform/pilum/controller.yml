#cloud-init

runcmd:
  - k0s install controller --single
  - systemctl enable k0scontroller
  - systemctl start k0scontroller
  - k0s status
  - k0s kubectl apply -f /root/hcloud-secret.yml
  - helm install hcloud

write_files:
  - path: /root/hcloud-secret.yml
    content: |
      apiVersion: v1
      kind: Secret
      metadata:
        name: hcloud
      type: Opaque
      data:
        token: MFR0NjhkM2VEall3bXdIMXZoR2Q2QlI3NHEwZVdmQ0dGYVBCUm1OWHpab2VoaXpZQnhQd0pPSVFER3MxYlFlcwo=   
    owner: 'root:root'
    permissions: '600'